<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Master System - Windows Edition</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --win-blue: #0078d4;
            --win-bg: #f3f2f1;
            --win-hover: #e1dfdd;
            --win-green: #217346;
        }

        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { margin: 0; background: var(--win-bg); display: flex; height: 100vh; overflow: hidden; }

        /* Sidebar - Tree View */
        .sidebar { width: 280px; background: #fff; border-left: 1px solid #d2d2d2; display: flex; flex-direction: column; }
        .sidebar-header { padding: 15px; background: #f8f8f8; font-weight: bold; border-bottom: 1px solid #d2d2d2; }
        .tree-root { flex: 1; overflow-y: auto; padding: 10px; }
        .tree-node { cursor: pointer; padding: 5px; border-radius: 3px; display: flex; align-items: center; gap: 8px; }
        .tree-node:hover { background: var(--win-hover); }
        .tree-children { margin-right: 20px; display: none; }
        .tree-children.open { display: block; }

        /* Main Workspace */
        .workspace { flex: 1; display: flex; flex-direction: column; }
        .ribbon { height: 120px; background: #fff; border-bottom: 1px solid #d2d2d2; padding: 10px; display: flex; gap: 20px; }
        .ribbon-group { border-left: 1px solid #eee; padding: 0 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px; }
        .ribbon-btn { background: none; border: 1px solid transparent; cursor: pointer; padding: 5px; border-radius: 3px; text-align: center; width: 80px; font-size: 11px; }
        .ribbon-btn:hover { background: var(--win-hover); border-color: #ccc; }
        .ribbon-btn img { display: block; margin: 0 auto 5px; width: 24px; }

        /* Explorer View (Files & Folders) */
        .explorer-view { flex: 1; padding: 20px; overflow-y: auto; background: #fff; }
        .file-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; }
        .item-card { text-align: center; padding: 10px; border: 1px solid transparent; cursor: pointer; position: relative; }
        .item-card:hover { background: #e5f3ff; border-color: #99d1ff; }
        .item-card.selected { background: #cce8ff; border-color: #66b3ff; }
        .item-icon { font-size: 40px; margin-bottom: 5px; }
        .item-name { font-size: 12px; word-break: break-all; outline: none; padding: 2px; }

        /* Excel View */
        .excel-view { display: none; flex: 1; padding: 20px; background: #fff; overflow-y: auto; }
        .excel-table { width: 100%; border-collapse: collapse; border: 1px solid #ccc; }
        .excel-table th, .excel-table td { border: 1px solid #ccc; padding: 8px; text-align: right; }
        .excel-input { width: 100%; border: none; outline: none; }

        .active-view { display: block !important; }
        
        /* Context Menu */
        #context-menu { position: absolute; background: #fff; border: 1px solid #ccc; box-shadow: 2px 2px 5px rgba(0,0,0,0.1); display: none; z-index: 1000; }
        #context-menu div { padding: 8px 20px; cursor: pointer; font-size: 13px; }
        #context-menu div:hover { background: var(--win-blue); color: #fff; }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="sidebar-header">×¡×™×™×¨ ×”× ×›×¡×™×</div>
        <div class="tree-root" id="tree-root"></div>
    </aside>

    <main class="workspace">
        <nav class="ribbon">
            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="createNew('folder')">ğŸ“‚<br>×ª×™×§×™×™×” ×—×“×©×”</button>
                <button class="ribbon-btn" onclick="document.getElementById('file-up').click()">ğŸ“¤<br>×”×¢×œ×” ×§×•×‘×¥</button>
                <input type="file" id="file-up" hidden multiple onchange="uploadFiles(this.files)">
            </div>
            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="showView('explorer')">ğŸ–¥ï¸<br>×ª×¦×•×’×ª ×§×‘×¦×™×</button>
                <button class="ribbon-btn" onclick="showView('excel')">ğŸ“Š<br>×¢×•×¨×š ××§×¡×œ</button>
            </div>
            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="deleteSelected()" style="color:red">ğŸ—‘ï¸<br>××—×§ ×¤×¨×™×˜</button>
                <button class="ribbon-btn" onclick="renameSelected()">âœï¸<br>×©× ×” ×©×</button>
            </div>
        </nav>

        <section id="explorer" class="explorer-view active-view">
            <div id="breadcrumb" style="padding-bottom: 15px; color: #666; font-size: 13px;">××—×©×‘ ×–×” > ×œ×§×•×—×•×ª</div>
            <div class="file-grid" id="file-grid"></div>
        </section>

        <section id="excel" class="excel-view">
            <h2 id="excel-title">×¢×•×¨×š ××¡××›×™×</h2>
            <table class="excel-table">
                <thead><tr style="background:#f3f3f3"><th>×ª×™××•×¨ ×©×™×¨×•×ª</th><th>×›××•×ª</th><th>××—×™×¨</th><th>×¡×”"×›</th></tr></thead>
                <tbody id="excel-body"></tbody>
            </table>
        </section>
    </main>

    <div id="context-menu">
        <div onclick="renameSelected()">×©× ×” ×©× (Rename)</div>
        <div onclick="deleteSelected()" style="color:red">××—×§ (Delete)</div>
        <div onclick="createNew('folder')">×ª×™×§×™×™×” ×—×“×©×”</div>
    </div>

    <script>
        let currentData = [
            { id: 1, name: "××—×–×§×•×ª ×“×¨×•×", type: "folder", children: [
                { id: 11, name: "×‘× ×™×™×Ÿ ×¨×™×‘×œ×™×Ÿ 4", type: "folder", children: [] },
                { id: 12, name: "×—×•×–×”_×—×ª×•×.pdf", type: "file" }
            ]},
            { id: 2, name: "×§×‘×•×¦×ª ×¢×–×¨×™××œ×™", type: "folder", children: [] }
        ];

        let selectedId = null;

        function renderExplorer(items) {
            const grid = document.getElementById('file-grid');
            grid.innerHTML = '';
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'item-card';
                if(selectedId === item.id) div.classList.add('selected');
                div.innerHTML = `
                    <div class="item-icon">${item.type === 'folder' ? 'ğŸ“' : 'ğŸ“„'}</div>
                    <div class="item-name" contenteditable="false" id="name-${item.id}">${item.name}</div>
                `;
                div.onclick = (e) => { e.stopPropagation(); selectItem(item.id); };
                div.ondblclick = () => { if(item.type === 'folder') renderExplorer(item.children); };
                grid.appendChild(div);
            });
        }

        function selectItem(id) {
            selectedId = id;
            renderExplorer(currentData); // Refresh selection
        }

        function createNew(type) {
            const newItem = { id: Date.now(), name: "×ª×™×§×™×™×” ×—×“×©×”", type: type, children: [] };
            currentData.push(newItem);
            renderExplorer(currentData);
        }

        function renameSelected() {
            if(!selectedId) return;
            const el = document.getElementById(`name-${selectedId}`);
            el.contentEditable = true;
            el.focus();
            el.onblur = () => {
                el.contentEditable = false;
                const item = findById(currentData, selectedId);
                item.name = el.innerText;
            };
        }

        function deleteSelected() {
            if(!selectedId) return;
            currentData = currentData.filter(i => i.id !== selectedId);
            selectedId = null;
            renderExplorer(currentData);
        }

        function findById(arr, id) {
            for (const item of arr) {
                if (item.id === id) return item;
                if (item.children) {
                    const found = findById(item.children, id);
                    if (found) return found;
                }
            }
        }

        function showView(view) {
            document.querySelectorAll('section').forEach(s => s.classList.remove('active-view'));
            document.getElementById(view).classList.add('active-view');
        }

        // Context Menu Logic
        window.oncontextmenu = (e) => {
            e.preventDefault();
            const menu = document.getElementById('context-menu');
            menu.style.display = 'block';
            menu.style.top = e.pageY + 'px';
            menu.style.left = e.pageX + 'px';
        };

        window.onclick = () => { document.getElementById('context-menu').style.display = 'none'; };

        renderExplorer(currentData);
    </script>
</body>
</html>
