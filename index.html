<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Master System v1.0 - ×—×œ×•× ×•×ª ×•× ×™×”×•×œ ××—×–×§×”</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --win-blue: #0078d4;
            --win-bg: #f3f2f1;
            --win-green: #217346;
            --win-hover: #edebe9;
            --border: #d2d2d2;
        }

        * { box-sizing: border-box; font-family: 'Segoe UI', Arial, sans-serif; }
        body { margin: 0; background: var(--win-bg); display: flex; height: 100vh; overflow: hidden; }

        /* Sidebar - Tree View */
        .sidebar { width: 260px; background: #fff; border-left: 1px solid var(--border); display: flex; flex-direction: column; }
        .sidebar-header { padding: 15px; background: #f8f8f8; font-weight: bold; border-bottom: 1px solid var(--border); }
        .tree-root { flex: 1; overflow-y: auto; padding: 10px; font-size: 13px; }
        .tree-node { cursor: pointer; padding: 6px; border-radius: 3px; display: flex; align-items: center; gap: 8px; }
        .tree-node:hover { background: var(--win-hover); }

        /* Main Workspace */
        .workspace { flex: 1; display: flex; flex-direction: column; }
        
        /* Ribbon Navigation */
        .ribbon { background: #fff; border-bottom: 1px solid var(--border); padding: 10px; display: flex; gap: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .ribbon-group { border-left: 1px solid #eee; padding: 0 15px; display: flex; align-items: center; gap: 10px; }
        .r-btn { border: 1px solid transparent; background: none; cursor: pointer; padding: 8px; border-radius: 4px; font-size: 12px; display: flex; flex-direction: column; align-items: center; min-width: 70px; }
        .r-btn:hover { background: var(--win-hover); border-color: #ccc; }
        .r-btn.active { background: var(--win-blue); color: #fff; }

        /* Search & Navigation Bar */
        .nav-bar { background: #fff; padding: 8px 15px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 15px; }
        .breadcrumb { flex: 1; font-size: 13px; color: #666; }
        .search-box { width: 250px; }
        .search-box input { width: 100%; padding: 5px 10px; border: 1px solid var(--border); border-radius: 3px; }

        /* Views */
        .view { flex: 1; padding: 20px; overflow-y: auto; display: none; }
        .active-view { display: block; }

        /* Explorer Grid */
        .file-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 15px; }
        .item-card { text-align: center; padding: 10px; border: 1px solid transparent; cursor: pointer; border-radius: 4px; transition: 0.1s; }
        .item-card:hover { background: #e5f3ff; border-color: #99d1ff; }
        .item-card.selected { background: #cce8ff; border-color: #66b3ff; }
        .item-icon { font-size: 40px; margin-bottom: 5px; }
        .item-name { font-size: 12px; word-break: break-all; outline: none; }

        /* Excel Sheet */
        .excel-table { width: 100%; border-collapse: collapse; background: #fff; }
        .excel-table th, .excel-table td { border: 1px solid var(--border); padding: 8px; text-align: right; }
        .excel-input { width: 100%; border: none; outline: none; font-size: 14px; }
        .excel-header { display: flex; justify-content: space-between; margin-bottom: 20px; border-bottom: 2px solid var(--win-green); padding-bottom: 10px; }

        /* BI Dashboard */
        .kpi-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px; }
        .kpi-card { background: #fff; padding: 20px; border-radius: 4px; border-top: 4px solid var(--win-green); box-shadow: 0 2px 4px rgba(0,0,0,0.05); }

        /* Context Menu */
        #ctx-menu { position: absolute; background: #fff; border: 1px solid #ccc; box-shadow: 2px 2px 8px rgba(0,0,0,0.15); display: none; z-index: 9999; min-width: 150px; }
        #ctx-menu div { padding: 8px 15px; cursor: pointer; font-size: 13px; }
        #ctx-menu div:hover { background: var(--win-blue); color: #fff; }
    </style>
</head>
<body onclick="hideContext()" oncontextmenu="showContext(event)">

    <aside class="sidebar">
        <div class="sidebar-header">××¢×¨×›×ª ×××¡×˜×¨ 2030</div>
        <div class="tree-root" id="sidebar-tree"></div>
    </aside>

    <main class="workspace">
        <nav class="ribbon">
            <div class="ribbon-group">
                <button class="r-btn" onclick="createNew('folder')">ğŸ“<br>×ª×™×§×™×™×”</button>
                <button class="r-btn" onclick="createNew('file')">ğŸ“„<br>××¡××š</button>
            </div>
            <div class="ribbon-group">
                <button class="r-btn" onclick="switchTab('explorer')">ğŸ–¥ï¸<br>×¡×™×™×¨</button>
                <button class="r-btn" onclick="switchTab('excel')">ğŸ“Š<br>××§×¡×œ</button>
                <button class="r-btn" onclick="switchTab('bi')">ğŸ“ˆ<br>×“×•×—×•×ª BI</button>
            </div>
            <div class="ribbon-group">
                <button class="r-btn" onclick="renameItem()">âœï¸<br>×©× ×” ×©×</button>
                <button class="r-btn" onclick="deleteItem()" style="color:red">ğŸ—‘ï¸<br>××—×§</button>
            </div>
        </nav>

        <div class="nav-bar">
            <div class="breadcrumb" id="breadcrumb">××—×©×‘ ×–×” > ×œ×§×•×—×•×ª</div>
            <div class="search-box">
                <input type="text" id="main-search" placeholder="×—×™×¤×•×© ××”×™×¨ ×‘×ª×™×§×™×•×ª..." oninput="searchFiles()">
            </div>
        </div>

        <section id="view-explorer" class="view active-view">
            <div class="file-grid" id="explorer-grid"></div>
        </section>

        <section id="view-excel" class="view">
            <div class="excel-header">
                <div><h2 id="ex-client">×‘×—×¨ ×œ×§×•×—</h2><p id="ex-project">×‘×—×¨ ×‘× ×™×™×Ÿ ×‘×¡×™×™×¨</p></div>
                <div style="text-align:left"><p>××¡×¤×¨: 1001</p><button onclick="addRow()">+ ×”×•×¡×£ ×©×•×¨×”</button></div>
            </div>
            <table class="excel-table">
                <thead><tr style="background:#f3f3f3"><th>×ª×™××•×¨</th><th>×›××•×ª</th><th>××—×™×¨</th><th>×¡×”"×›</th></tr></thead>
                <tbody id="excel-body"></tbody>
            </table>
        </section>

        <section id="view-bi" class="view">
            <div class="kpi-row">
                <div class="kpi-card"><span>×”×›× ×¡×•×ª</span><h3>â‚ª 124,500</h3></div>
                <div class="kpi-card"><span>×—×•×‘×•×ª</span><h3 style="color:red">â‚ª 12,000</h3></div>
                <div class="kpi-card"><span>×‘× ×™×™× ×™×</span><h3>42</h3></div>
                <div class="kpi-card"><span>×§×¨×™××•×ª</span><h3>8</h3></div>
            </div>
            <div style="background:#fff; padding:20px; height:300px;"><canvas id="biChart"></canvas></div>
        </section>
    </main>

    <div id="ctx-menu">
        <div onclick="renameItem()">×©× ×” ×©× (F2)</div>
        <div onclick="deleteItem()">××—×§ (Delete)</div>
        <div onclick="createNew('folder')">×ª×™×§×™×™×” ×—×“×©×”</div>
    </div>

    <script>
        // ××‘× ×” × ×ª×•× ×™× ×”×ª×—×œ×ª×™
        let fileSystem = [
            { id: 1, name: "××—×–×§×•×ª ××‘×™×‘", type: "folder", children: [
                { id: 11, name: "××’×“×œ ×”×××”", type: "folder", children: [] },
                { id: 12, name: "×‘× ×™×™×Ÿ ×“×§×œ", type: "folder", children: [] }
            ]},
            { id: 2, name: "×§×‘×•×¦×ª ×¢×–×¨×™××œ×™", type: "folder", children: [] }
        ];

        let folderStack = [fileSystem];
        let pathNames = [];
        let selectedId = null;

        // ××ª×—×•×œ
        window.onload = () => {
            renderExplorer();
            renderSidebar();
            initChart();
            for(let i=0; i<5; i++) addRow();
        };

        // ×¨× ×“×•×¨ ×¡×™×™×¨ ×”×§×‘×¦×™×
        function renderExplorer() {
            const grid = document.getElementById('explorer-grid');
            const bc = document.getElementById('breadcrumb');
            grid.innerHTML = '';
            
            bc.innerHTML = '<span onclick="jumpTo(-1)" style="cursor:pointer; color:blue">××—×©×‘ ×–×”</span>';
            pathNames.forEach((n, i) => bc.innerHTML += ` > <span onclick="jumpTo(${i})" style="cursor:pointer; color:blue">${n}</span>`);

            const currentLevel = folderStack[folderStack.length - 1];
            currentLevel.forEach(item => {
                const div = document.createElement('div');
                div.className = `item-card ${selectedId === item.id ? 'selected' : ''}`;
                div.innerHTML = `<div class="item-icon">${item.type === 'folder' ? 'ğŸ“' : 'ğŸ“„'}</div>
                                 <div class="item-name" id="name-${item.id}" contenteditable="false">${item.name}</div>`;
                
                div.onclick = (e) => { e.stopPropagation(); selectedId = item.id; renderExplorer(); };
                div.ondblclick = () => { if(item.type === 'folder') { folderStack.push(item.children); pathNames.push(item.name); renderExplorer(); updateExcelInfo(item.name); } };
                grid.appendChild(div);
            });
        }

        function updateExcelInfo(name) {
            document.getElementById('ex-project').innerText = "×‘× ×™×™×Ÿ: " + name;
        }

        function jumpTo(index) {
            folderStack = folderStack.slice(0, index + 2);
            pathNames = pathNames.slice(0, index + 1);
            renderExplorer();
        }

        function createNew(type) {
            const newItem = { id: Date.now(), name: type === 'folder' ? "×ª×™×§×™×™×” ×—×“×©×”" : "××¡××š ×—×“×©", type, children: type === 'folder' ? [] : null };
            folderStack[folderStack.length - 1].push(newItem);
            renderExplorer();
            renderSidebar();
        }

        function deleteItem() {
            if(!selectedId) return;
            const current = folderStack[folderStack.length - 1];
            const idx = current.findIndex(i => i.id === selectedId);
            current.splice(idx, 1);
            selectedId = null;
            renderExplorer();
            renderSidebar();
        }

        function renameItem() {
            if(!selectedId) return;
            const el = document.getElementById(`name-${selectedId}`);
            el.contentEditable = true;
            el.focus();
            el.onblur = () => {
                el.contentEditable = false;
                const item = folderStack[folderStack.length - 1].find(i => i.id === selectedId);
                item.name = el.innerText;
                renderSidebar();
            };
        }

        function switchTab(tab) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
            document.getElementById('view-' + tab).classList.add('active-view');
        }

        function addRow() {
            const b = document.getElementById('excel-body');
            const r = b.insertRow();
            r.innerHTML = `<td><input class="excel-input" placeholder="..."></td><td><input class="excel-input" type="number" value="1"></td><td><input class="excel-input" type="number" value="0"></td><td>0.00</td>`;
        }

        function renderSidebar() {
            const tree = document.getElementById('sidebar-tree');
            tree.innerHTML = fileSystem.map(c => `<div class="tree-node">ğŸ“‚ ${c.name}</div>`).join('');
        }

        function showContext(e) {
            e.preventDefault();
            const m = document.getElementById('ctx-menu');
            m.style.display = 'block'; m.style.top = e.pageY + 'px'; m.style.left = e.pageX + 'px';
        }
        function hideContext() { document.getElementById('ctx-menu').style.display = 'none'; }

        function initChart() {
            new Chart(document.getElementById('biChart'), {
                type: 'line',
                data: { labels: ['×™× ×•', '×¤×‘×¨', '××¨×¥', '××¤×¨'], datasets: [{ label: '×”×›× ×¡×•×ª', data: [12, 19, 15, 25], borderColor: '#217346' }] },
                options: { maintainAspectRatio: false }
            });
        }
    </script>
</body>
</html>
